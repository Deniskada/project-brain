# üîß –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø–æ–∏—Å–∫–∞

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

**–ü—Ä–∏–º–µ—Ä:** 
- –í–æ–ø—Ä–æ—Å: "–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç?"
- AI –Ω–∞—Ö–æ–¥–∏—Ç: `domain/entities/object.py` (–º–æ–¥–µ–ª—å)
- –ù–µ –Ω–∞—Ö–æ–¥–∏—Ç: `apps/web/routes/objects.py` (—Ä–æ—É—Ç —Å —Ñ–æ—Ä–º–æ–π —Å–æ–∑–¥–∞–Ω–∏—è)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** AI –Ω–µ –º–æ–∂–µ—Ç –¥–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –¢–µ—Å—Ç 1: –ü–æ–∏—Å–∫ –ø–æ —Ä–æ—É—Ç–∞–º
```bash
curl -X POST http://localhost:8003/api/query \
  -d '{"query": "—Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç create object"}' 
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∞—Ö–æ–¥–∏—Ç –º–æ–¥–µ–ª—å, –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç —Ä–æ—É—Ç ‚ùå

### –¢–µ—Å—Ç 2: –ü–æ–∏—Å–∫ —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º
```bash
curl -X POST http://localhost:8003/api/query \
  -d '{"query": "apps/web/routes/objects.py create_object"}' 
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–∞–π–ª

## üí° –†–µ—à–µ–Ω–∏—è (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)

### ‚ö° –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ (30 –º–∏–Ω—É—Ç) - –î–ï–õ–ê–ï–ú –°–ï–ô–ß–ê–°

#### 1. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
```python
# backend/indexers/python_indexer.py
metadata = {
    'file': relative_path,
    'type': chunk['type'],
    'doc_type': self._classify_doc_type(relative_path),  # ‚Üê –î–û–ë–ê–í–ò–¢–¨
    'start_line': chunk.get('start_line', 0),
    'end_line': chunk.get('end_line', 0),
}

def _classify_doc_type(self, file_path: str) -> str:
    """–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
    if 'routes' in file_path or 'api' in file_path:
        return 'route'
    elif 'models' in file_path or 'entities' in file_path:
        return 'model'
    elif 'services' in file_path:
        return 'service'
    elif 'handlers' in file_path:
        return 'handler'
    return 'other'
```

#### 2. –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–º–ø—Ç –≤ RAGEngine
```python
# backend/rag/engine.py
async def retrieve_context(self, query: str, ...) -> List[Dict]:
    # –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞
    query_type = self._detect_query_type(query)
    
    # –ï—Å–ª–∏ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç "–∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å" - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ä–æ—É—Ç–∞–º
    if query_type == 'how_to':
        where_clause = {"$or": [
            {"doc_type": "route"},
            {"doc_type": "handler"}
        ]}
    
    results = self.collection.query(
        query_embeddings=[query_embedding],
        where=where_clause,  # ‚Üê –î–û–ë–ê–í–ò–¢–¨ —Ñ–∏–ª—å—Ç—Ä
        n_results=top_k
    )
```

#### 3. –î–æ–±–∞–≤–∏—Ç—å —Å–∏–Ω–æ–Ω–∏–º—ã –≤ –ø—Ä–æ–º–ø—Ç
```python
def _build_prompt(self, query: str, context: List[Dict]) -> str:
    # –†–∞—Å—à–∏—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏
    enriched_query = self._enrich_query(query)
    # "—Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç" ‚Üí "—Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç, create object, —Ñ–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è, —Ä–æ—É—Ç"
```

### üöÄ –°—Ä–µ–¥–Ω–µ–µ —Ä–µ—à–µ–Ω–∏–µ (2 —á–∞—Å–∞)

#### 4. –î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø–æ–∏—Å–∫
```python
# 1. –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ —Ç–∏–ø—É
route_results = search(query, doc_type='route')

# 2. –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ - –ø–æ–∏—Å–∫ –≤–µ–∑–¥–µ
if not route_results:
    all_results = search(query)
```

#### 5. –ü–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```python
# –ü–æ—Å–ª–µ –ø–æ–∏—Å–∫–∞ - –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏
for result in results:
    # –†–æ—É—Ç—ã –≤–∞–∂–Ω–µ–µ –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ "–∫–∞–∫"
    if '–∫–∞–∫' in query or 'how' in query:
        if result['doc_type'] == 'route':
            result['score'] *= 1.5  # –ë—É—Å—Ç –¥–ª—è —Ä–æ—É—Ç–æ–≤
```

### üéØ –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (1 –¥–µ–Ω—å)

#### 6. –§–∞–π–Ω-—Ç—é–Ω–∏–Ω–≥ –º–æ–¥–µ–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
```python
# –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –ø–∞—Ä–∞—Ö (–≤–æ–ø—Ä–æ—Å, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–∞–π–ª)
training_data = [
    ("–∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç", "apps/web/routes/objects.py"),
    ("–∫–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É", "apps/bot/handlers.py"),
    # ... 100+ –ø—Ä–∏–º–µ—Ä–æ–≤
]
```

#### 7. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –æ–∫–Ω–æ
```python
# –ù–µ —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏—è, –Ω–æ –∏ —Å–æ—Å–µ–¥–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
chunk = {
    'content': function_code,
    'context_before': previous_function,
    'context_after': next_function,
}
```

## üõ†Ô∏è –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π (–ü–†–Ø–ú–û –°–ï–ô–ß–ê–°)

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (10 –º–∏–Ω—É—Ç)
- [x] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `python_indexer.py`
- [x] –î–æ–±–∞–≤–∏—Ç—å `doc_type` –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- [x] –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø—É—Ç–∏ —Ñ–∞–π–ª–∞

### –®–∞–≥ 2: –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–º–ø—Ç (10 –º–∏–Ω—É—Ç)
- [x] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `ollama_client.py`
- [x] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–∏–ø–∞ –∑–∞–ø—Ä–æ—Å–∞
- [x] –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Ä–æ—É—Ç–æ–≤ –¥–ª—è "–∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å"

### –®–∞–≥ 3: –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è (10 –º–∏–Ω—É—Ç)
- [x] –ó–∞–ø—É—Å—Ç–∏—Ç—å `/api/index/staffprobot`
- [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `doc_type` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- [x] –¢–µ—Å—Ç: –≤–æ–ø—Ä–æ—Å "–∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç"

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ (5 –º–∏–Ω—É—Ç)
```bash
# –î–æ —É–ª—É—á—à–µ–Ω–∏–π
curl -X POST http://localhost:8003/api/query \
  -d '{"query": "—á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç?"}'
# –ù–∞—Ö–æ–¥–∏—Ç: domain/entities/object.py ‚ùå

# –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π
# –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏: apps/web/routes/objects.py ‚úÖ
```

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:
- ‚ùå –ù–∞—Ö–æ–¥–∏—Ç –º–æ–¥–µ–ª—å –≤–º–µ—Å—Ç–æ —Ä–æ—É—Ç–∞
- ‚ùå AI –Ω–µ –º–æ–∂–µ—Ç –¥–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:
- ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–æ—É—Ç
- ‚úÖ AI –¥–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–≤–æ–ª–µ–Ω

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

**–¢–µ—Å—Ç 1:** "–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç?"
- –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏: `apps/web/routes/objects.py`
- –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å: —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è, –ø–æ–ª—è, –≤–∞–ª–∏–¥–∞—Ü–∏—é

**–¢–µ—Å—Ç 2:** "–ö–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É?"
- –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏: `apps/bot/handlers.py` –∏–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
- –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å: –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞, –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–∫—Ä—ã—Ç–∏—è

**–¢–µ—Å—Ç 3:** "–ö–∞–∫–∏–µ –ø–æ–ª—è –≤ –º–æ–¥–µ–ª–∏ User?"
- –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏: `domain/entities/user.py`
- –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å: —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π —Å —Ç–∏–ø–∞–º–∏

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –£–ª—É—á—à–µ–Ω–∏—è **–Ω–µ —Å–ª–æ–º–∞—é—Ç** —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- –ú–æ–∂–Ω–æ **–æ—Ç–∫–∞—Ç–∏—Ç—å** –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç
- **30 –º–∏–Ω—É—Ç** —Ä–∞–±–æ—Ç—ã –¥–ª—è –∑–∞–º–µ—Ç–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è
- **ROI –≤—ã—Å–æ–∫–∏–π** - —Å—Ä–∞–∑—É –≤–∏–¥–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã


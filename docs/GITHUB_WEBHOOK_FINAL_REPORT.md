# üéØ GitHub Auto-Update: –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (100%)

### 1. Webhook —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ Endpoint `/api/webhook/github` - –ø—Ä–∏–µ–º —Å–æ–±—ã—Ç–∏–π –æ—Ç GitHub
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ HMAC-SHA256
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ push —Å–æ–±—ã—Ç–∏–π –≤ main/master
- ‚úÖ –§–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ BackgroundTasks
- ‚úÖ –°—Ç–∞—Ç—É—Å API `/api/webhook/status/{project}`

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ `.env` —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω —Å —Å–µ–∫—Ä–µ—Ç–æ–º webhook
- ‚úÖ `config/projects.yaml` –æ–±–Ω–æ–≤–ª—ë–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—É—Ç—è–º–∏
- ‚úÖ Docker volumes –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

### 3. –°–∫—Ä–∏–ø—Ç—ã
- ‚úÖ `scripts/simple_reindex.py` - —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
- ‚úÖ `scripts/test_queries.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ RAG
- ‚úÖ `tests/test_staffprobot_queries.json` - 25 —Ç–µ—Å—Ç–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ `docs/GITHUB_AUTO_UPDATE_GUIDE.md` - –ø–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- ‚úÖ `docs/GITHUB_WEBHOOK_STATUS.md` - —Å—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ `docs/USAGE_ANALYSIS.md` - –æ–±–Ω–æ–≤–ª—ë–Ω

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å

### 1. –î–æ–±–∞–≤–∏—Ç—å webhook –≤ GitHub (5 –º–∏–Ω—É—Ç)

**–î–ª—è StaffProBot:**
1. –û—Ç–∫—Ä—ã—Ç—å: https://github.com/Deniskada/staffprobot/settings/hooks
2. Add webhook:
   - Payload URL: `https://dev.staffprobot.ru/api/webhook/github`
   - Content type: `application/json`
   - Secret: `f00872ab2116aa77a1931cbaa594cf3bf77b63ecf9a7739955366511fb14f42e`
   - Events: ‚úÖ Just the push event
3. Save

**–î–ª—è Project-Brain (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è https://github.com/Deniskada/project-brain/settings/hooks

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é (10-15 –º–∏–Ω—É—Ç)

```bash
# –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
cd /home/sa/projects/project-brain
docker compose -f docker-compose.local.yml exec api python /app/scripts/simple_reindex.py staffprobot

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ API
curl -X POST http://192.168.2.107:8003/api/webhook/manual-reindex/staffprobot
```

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø—Ä–æ–≤–µ–¥–µ–Ω–æ)
- **–ó–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:** 10/25
- **–£—Å–ø–µ—à–Ω—ã—Ö:** 10/10 (100%)
- **–°—Ä–µ–¥–Ω–µ–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:** 3.3
- **Keyword score:** 12% (–Ω–∏–∑–∫–∏–π - –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –Ω–µ–ø–æ–ª–Ω–∞—è)

### –ü—Ä–æ–±–ª–µ–º—ã
1. ‚ùå **–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –Ω–µ–ø–æ–ª–Ω–∞—è** - RAG –æ—Ç–≤–µ—á–∞–µ—Ç "–í —Ç–µ–∫—É—â–µ–π –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ —Ç–∞–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–µ—Ç"
2. ‚ùå **Webhook –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ GitHub** - –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. ‚ö†Ô∏è **Memory issue** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–±–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ (Exit 137)

## üöÄ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –≤ GitHub (—Å–µ–π—á–∞—Å)
```bash
# –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
https://github.com/Deniskada/staffprobot/settings/hooks

# –î–æ–±–∞–≤–∏—Ç—å webhook —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤—ã—à–µ
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é (–ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
cd /home/sa/projects/project-brain
docker compose -f docker-compose.local.yml exec api python /app/scripts/simple_reindex.py staffprobot

# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
docker compose -f docker-compose.local.yml logs api -f | grep "üìä –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ"
```

### –®–∞–≥ 3: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å RAG (–ø–æ—Å–ª–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏)
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
docker compose -f docker-compose.local.yml exec api python /app/scripts/test_queries.py

# –ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å
curl -X POST http://192.168.2.107:8003/api/query \
  -H "Content-Type: application/json" \
  -d '{"query":"–ö–∞–∫–∏–µ —Ä–æ–ª–∏ –µ—Å—Ç—å –≤ StaffProBot?","project":"staffprobot"}'
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é (–ø–æ—Å–ª–µ webhook)
```bash
# –°–¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π commit
cd /home/sa/projects/staffprobot
echo "test webhook" > test_auto.md
git add test_auto.md
git commit -m "–¢–µ—Å—Ç: –∞–≤—Ç–æ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è"
git push origin main

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã
curl http://192.168.2.107:8003/api/webhook/status/staffprobot
```

## üìã –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ (25 —à—Ç—É–∫)

–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `tests/test_staffprobot_queries.json` —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** (–ª–µ–≥–∫–∏–µ) - 2 –≤–æ–ø—Ä–æ—Å–∞
   - –ö–∞–∫–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞?

2. **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** (—Å—Ä–µ–¥–Ω–∏–µ) - 4 –≤–æ–ø—Ä–æ—Å–∞
   - –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ —Å–º–µ–Ω
   - Workflow –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

3. **API** (—Å—Ä–µ–¥–Ω–∏–µ) - 4 –≤–æ–ø—Ä–æ—Å–∞
   - Endpoints –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤
   - Endpoints –¥–ª—è —Å–º–µ–Ω

4. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** (–ª–µ–≥–∫–∏–µ/—Å–ª–æ–∂–Ω—ã–µ) - 3 –≤–æ–ø—Ä–æ—Å–∞
   - –ú–æ–¥–µ–ª–∏ –∏ –ø–æ–ª—è
   - –°–≤—è–∑–∏ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏

5. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** (—Å—Ä–µ–¥–Ω–∏–µ/—Å–ª–æ–∂–Ω—ã–µ) - 3 –≤–æ–ø—Ä–æ—Å–∞
   - –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç auth?
   - telegram_id vs user_id

6. **–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è** (—Å—Ä–µ–¥–Ω–∏–µ) - 2 –≤–æ–ø—Ä–æ—Å–∞
7. **Telegram Bot** (–ª–µ–≥–∫–∏–µ/—Å—Ä–µ–¥–Ω–∏–µ) - 3 –≤–æ–ø—Ä–æ—Å–∞
8. **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** (–ª–µ–≥–∫–∏–µ/—Å—Ä–µ–¥–Ω–∏–µ) - 3 –≤–æ–ø—Ä–æ—Å–∞
9. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è/–î–µ–ø–ª–æ–π** (–ª–µ–≥–∫–∏–µ/—Å–ª–æ–∂–Ω—ã–µ) - 4 –≤–æ–ø—Ä–æ—Å–∞
10. **–û—Ç–ª–∞–¥–∫–∞** (–ª–µ–≥–∫–∏–µ/—Å—Ä–µ–¥–Ω–∏–µ) - 2 –≤–æ–ø—Ä–æ—Å–∞

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
# –í—Å–µ 25 –≤–æ–ø—Ä–æ—Å–æ–≤
docker compose -f docker-compose.local.yml exec api python /app/scripts/test_queries.py

# –ò–ª–∏ –ø–µ—Ä–≤—ã–µ 10
docker compose -f docker-compose.local.yml exec api python -c "
import sys; sys.path.insert(0, '/app')
from scripts.test_queries import main
main()
"
```

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏)

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: 90-100%
- ‚úÖ –°—Ä–µ–¥–Ω–µ–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: 5-10
- ‚úÖ Keyword score: 60-80%
- ‚úÖ –û—Ç–≤–µ—Ç—ã —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ –∏ —Å—Ç—Ä–æ–∫–∞–º–∏ –∫–æ–¥–∞

### –ü—Ä–∏–º–µ—Ä—ã —Ö–æ—Ä–æ—à–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤:
```
Q: –ö–∞–∫–∏–µ —Ä–æ–ª–∏ –µ—Å—Ç—å –≤ StaffProBot?
A: –í —Å–∏—Å—Ç–µ–º–µ 5 —Ä–æ–ª–µ–π: owner (–≤–ª–∞–¥–µ–ª–µ—Ü), manager (—É–ø—Ä–∞–≤–ª—è—é—â–∏–π), 
   employee (—Å–æ—Ç—Ä—É–¥–Ω–∏–∫), admin (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä), moderator (–º–æ–¥–µ—Ä–∞—Ç–æ—Ä).
   –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ domain/entities/user.py
   
Q: –ì–¥–µ –º–æ–¥–µ–ª—å User?
A: –ú–æ–¥–µ–ª—å User –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ domain/entities/user.py, —Å—Ç—Ä–æ–∫–∏ 15-45
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Webhook —Å–µ–∫—Ä–µ—Ç:
```
GITHUB_WEBHOOK_SECRET=f00872ab2116aa77a1931cbaa594cf3bf77b63ecf9a7739955366511fb14f42e
```

**–í–∞–∂–Ω–æ:**
- ‚úÖ –°–µ–∫—Ä–µ—Ç 256-–±–∏—Ç (64 —Å–∏–º–≤–æ–ª–∞ hex)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ HMAC-SHA256 –≤–∫–ª—é—á–µ–Ω–∞
- ‚úÖ Timing-safe comparison
- ‚ö†Ô∏è –ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å —Å–µ–∫—Ä–µ—Ç –≤ git
- ‚ö†Ô∏è –ú–µ–Ω—è—Ç—å —Å–µ–∫—Ä–µ—Ç –∫–∞–∂–¥—ã–µ 3-6 –º–µ—Å—è—Ü–µ–≤

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- `project-brain/.env` - —Å–µ–∫—Ä–µ—Ç webhook
- `project-brain/config/projects.yaml` - –ø—É—Ç–∏ –∫ –ø—Ä–æ–µ–∫—Ç–∞–º

### –°–∫—Ä–∏–ø—Ç—ã:
- `project-brain/scripts/simple_reindex.py` - –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
- `project-brain/scripts/test_queries.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç—ã:
- `project-brain/tests/test_staffprobot_queries.json` - 25 –≤–æ–ø—Ä–æ—Å–æ–≤

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `project-brain/docs/GITHUB_AUTO_UPDATE_GUIDE.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- `project-brain/docs/GITHUB_WEBHOOK_STATUS.md` - —Å—Ç–∞—Ç—É—Å
- `project-brain/docs/GITHUB_WEBHOOK_FINAL_REPORT.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

### –û–±–Ω–æ–≤–ª–µ–Ω–æ:
- `project-brain/backend/api/routes/webhook.py` - —Å—Ç–∞—Ç—É—Å endpoints
- `project-brain/docker-compose.local.yml` - volumes –¥–ª—è git
- `project-brain/docs/USAGE_ANALYSIS.md` - —Ä–∞–∑–¥–µ–ª –ø—Ä–æ webhook

## üéâ –ò—Ç–æ–≥

### ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
1. Webhook API —Ä–∞–±–æ—Ç–∞–µ—Ç
2. –°—Ç–∞—Ç—É—Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è
3. –¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã
4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è

### üîß –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
1. –î–æ–±–∞–≤–∏—Ç—å webhook –≤ GitHub (5 –º–∏–Ω—É—Ç)
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é (10-15 –º–∏–Ω—É—Ç)
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤

### üöÄ –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- **git push** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
- –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞
- RAG –æ—Ç–≤–µ—á–∞–µ—Ç —Å —É—á—ë—Ç–æ–º –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –î–æ–±–∞–≤–∏—Ç—å webhook –≤ GitHub –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é

